# Обзор проекта: серверная часть мессенджера

## ТЗ

**Необходимо, спроектировать и написать мессенджер.**

_Функциональность мессенджера:_

- Регистрация пользователей
- Авторизация пользователей
- Создание p2p чатов с пользователеми по id пользователя
- Создание групповых чатов с пользователями по id пользователей
- Отправка сообщения в чат по вебсокету(hapi nes)
- Получение списка своих чатов
- Получение сообщений по выбранному чату с пагинацией
- Удаление чата
- Удаление сообщения из чата (для всех, только для себя)
- Получение данных профиля собеседника
- Отображение статусов сообщений(Не доставлено, доставлено, прочитано)
- Тестирование через hapi-lab или jest

**Требуется оценка, архитектура базы данных, архитектура сервисов.**

## Обзор проекта

### Цель - Спроектировать и написать серверную часть мессенджера

### Команда

- Менеджер проекта: Валерий
- Программист: Валерий

### Сроки выполнения проекта

    Дата начала: 25.02.2022

    Длительность: 1 месяц

    Завершение: 25.04.2022

    Завершение: крайний срок 31.04.2022

### Используемые технологии

- Node JS версия 14+
- TypeScript
- Сервер реализован с помощью фреймворка Hapi
- База данных Postgres
- Для взаимодействия с базой данных используется ORM Sequelize
- Для тестирования используется hapi/lab и библиотека утверждений code
- Ветвление с помощью git-flow

### Этапы

- **Подготовительный этап**

  - _Ветка: develop_

- **Регистрация пользователей**

  - _Ветка: reg_

- **Тестирование route /registration**

  - _Ветка test-reg_

- **Авторизация пользователей**

  - Ветка: feature2
  - Route: /login
  - Method: GET
  - Controller: userLogin()
  - Model: User

- **Тестирование route /login, ветка feature2/test**

- **Создание p2p чатов с пользователями по id пользователя**

  - Ветка: feature3
  - Route: /chat/create
  - Method: POST
  - Controller: chatCreate()
  - Model: Chat

- **Тестирование route /chat/create, ветка feature3/test**

- **Создание групповых чатов с пользователями по id пользователей**

  - _Пока кажеться, что можно сделать одним роутом_
  - Ветка: feature
  - Route: /chat/create
  - Method: POST
  - Controller: chatCreate()
  - Model: Chat

- **Получение списка своих чатов**

  - Ветка: feature
  - Route: /chat/{userId}
  - Method: GET
  - Controller: getChatList()
  - Model: Chat

- **Тестирование route /chat/{userId}, ветка feature/test**

- **Получение сообщений по выбранному чату с пагинацией**

  - Ветка: feature
  - Route: /message/{chatId}
  - Method: GET
  - Controller: getMessages()
  - Model: Message

- **Тестирование route /message/{chatId}, ветка feature/test**

- **Удаление чата**

  - Ветка: feature
  - Route: /chat/{chatId}
  - Method: DELETE
  - Controller: deleteChat()
  - Model: Chat

- **Тестирование route /chat/{chatId}, ветка feature/test**

- **Получение данных профиля собеседника**

  - Ветка: feature
  - Route: /user/{userId}
  - Method: GET
  - Controller: getInfoUser()
  - Model: User

- **Тестирование route /user/{userId}, ветка feature/test**

- Удаление сообщения из чата (для всех, только для себя)
- Отображение статусов сообщений(Не доставлено, доставлено, прочитано)
- Отправка сообщения в чат по вебсокету(hapi nes)

### Архитектура сетевых взаимодействий

- Для передачи сообщений между пользователями, используется websocket hapi/nes
- Остальные взаимодейтвия между клиентом и сервером, осуществляются с помощью HTTP запросов

## Архитектура базы данных

## Архитектура сервисов

### Общая структура проекта

- Описание папок

### Подготовительный этап

- Добавление файла конфигурации
- Добавление файла .env, который содержит настройки приложения
- Добавление подключения к БД, models/index.ts
- Добавление сервера
- Добавление перечисления с ошибкам
- Добавление скрипта запуска приложения

### Сервис регистрации пользователей

- Route: /registration
- Method: POST
- Handler: userRegistration()
- Model: User
- Пароль храниться в БД в зашифрованом виде
